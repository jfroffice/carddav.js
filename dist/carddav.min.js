/**
 * carddav.js - jQuery API to access read-only CardDav Server (like DaviCal)
 * @version v0.2.1
 * @link https://github.com/jfroffice/carddav.js
 * @license MIT
 */
var webdav=function(e,r){"use strict";function t(e,t){return"Basic "+r(e+":"+t)}function s(e,r,s,o){e.setRequestHeader("Authorization",t(r,s)),e.setRequestHeader("X-client","webdav.js Client "+n),e.setRequestHeader("Depth",o?"0":o)}var n="0.2.0",o={cache:!1,crossDomain:!0,async:!0,xhrFields:{withCredentials:!1},timeout:3e4,contentType:"text/xml; charset=utf-8",processData:!0,dataType:"xml"};return{propFind:function(r){r=e.extend({},o,r),e.ajax({type:"PROPFIND",url:r.url,data:'<?xml version="1.0" encoding="utf-8"?><D:propfind xmlns:D="DAV:">'+r.data+"</D:propfind>",beforeSend:function(e){s(e,r.user,r.passwd)},error:function(e,t,s){return r.error&&r.error(e,t,s),!1},complete:function(e,t){r.success&&r.success(e,t)}})},report:function(r){r=e.extend({},o,r),e.ajax({type:"REPORT",url:r.url,data:r.realData||'<?xml version="1.0" encoding="utf-8"?><D:sync-collection xmlns:D="DAV:">'+r.data+"</D:sync-collection>",beforeSend:function(e){s(e,r.user,r.passwd)},error:function(e,t,s){return r.error&&r.error(e,t,s),!1},complete:function(e,t){r.success&&r.success(e,t)}})}}}(jQuery,this.btoa);!function(e,r){"use strict";function t(e){var r,t,s,n,o,c,i={simple:/^(version|fn|n|title|org|note|uid|rev|categories)\:(.+)$/i,complex:/^([^\:\;]+);([^\:]+)\:(.+)$/,key:/item\d{1,2}\./,properties:/((type=)?(.+);?)+/},a={},u=e.split("\n"),p={},d={categories:function(e){return e.split(",")},Name:function(e){return e.split(";")}};for(var l in u)u.hasOwnProperty(l)&&(r=u[l],i.simple.test(r)?(t=r.match(i.simple),s=t[1].toLowerCase(),n=t[2],a[p[s]||s]=d[s]?d[s](n):n):i.complex.test(r)&&(t=r.match(i.complex),s=t[1].replace(i.key,"").toLowerCase(),o=t[2].split(";"),c=o.pop()||"default",c=c.toLowerCase(),n=t[3],n=/;/.test(n)?[n.split(";")]:n,a[s]=a[s]||{},a[s][c]=a[s][c]||[],a[s][c]=a[s][c].concat(n)));return a}function s(s,n,o,c){r.report({url:s.url,user:s.user,passwd:s.passwd,realData:n,error:function(e,r,t){o&&o(e,r,t)},success:function(r,n){if("success"!==n||!s.success)return!1;var o=[];e(r.responseXML).find("response").each(function(){var r=e(this).find("href").text();e(this).find("prop").children().each(function(s){1===s&&o.push({url:r,vcard:t(e(this).text())})})}),c&&c(o)}})}function n(r){var t='<?xml version="1.0" encoding="utf-8"?><E:addressbook-multiget xmlns:E="urn:ietf:params:xml:ns:carddav"><A:prop xmlns:A="DAV:"><A:getetag/><E:address-data/></A:prop>';return e(r.responseXML).find("href").each(function(){t+='<A:href xmlns:A="DAV:">'+e(this).text()+"</A:href>"}),t+"</E:addressbook-multiget>"}var o="0.2.0";e.carddav={version:o,get:function(e){r.report({url:e.url,user:e.user,passwd:e.passwd,data:"<D:sync-token/><D:prop><D:getcontenttype/></D:prop>",error:function(r,t,s){e.error&&e.error(r,t,s)},success:function(r,t){return"success"===t&&e.success?void s(e,n(r),e.error,e.success):!1}})}}}(jQuery,this.webdav);